---
aliases: [提示词优秀样例-数据处理-代码生成]
创建时间: 2025-04-16 18:15
最新更新时间: 2025-04-23 15:23
---
>[!example]-  利用正则表达式处理指定表头的内容
>```markdown
> 先不用写代码，先仔细分析这个函数功能  
>   
> 功能：读取工作簿里指定的表，利用正则表达式处理指定表头的内容
> 具体处理逻辑：利用正则表达式，删除指定列的部分内容：删去类似“厂商编号为N1404，，”的内容
> 删除例子：
> - 原本内容："名称为阳江鸿禧家庭用品有限公司的厂商，其信息如下：厂商编号为AKF125，主营产品为烘焙用品、厨房五金工具，联系方式为曾仕喜 总经理 手机：18926359852 地址：广东省阳江市江城区卫城路259号二楼，主销市场为暂无记录，验厂/认证为ISO 9001、ISO 14001、BSCI，合作情况为暂无记录，是否供样为暂无记录，网址为暂无记录，备注为暂无记录。"
> - 删除后的内容："名称为阳江鸿禧家庭用品有限公司的厂商，其信息如下：主营产品为烘焙用品、厨房五金工具，联系方式为曾仕喜 总经理 手机：18926359852 地址：广东省阳江市江城区卫城路259号二楼，主销市场为暂无记录，验厂/认证为ISO 9001、ISO 14001、BSCI，合作情况为暂无记录，是否供样为暂无记录，网址为暂无记录，备注为暂无记录。"
> - 删除说明：删去“厂商编号为AKF125，”
> 参数：输入的表格路径，要处理的sheet名字列表，要处理的表头名字列表，输出的表格路径，列名所在的行数，处理的正则表达式
> 要求：使用xlwings库  
> 日志要求：给出详细的日志记录，每一个单元格的前后变化要打印出来，方便我跟踪程序和分析工作簿状态
> 注意事项：要正确打开关闭工作簿，警惕文件、进程锁的问题  
> 细节：要有异常捕捉机制
> ```




>[!example]- 指定表头的内容统一在后面追加指定内容
>```markdown
>先不用写代码，先仔细分析这个函数功能  
>   
> 功能：读取工作簿里指定的表，指定表头的内容统一在后面追加指定内容
> 
> 追加例子：
> - 原本内容："名称为阳江鸿禧家庭用品有限公司的厂商，其信息如下：主营产品为烘焙用品、厨房五金工具，联系方式为曾仕喜 总经理 手机：18926359852 地址：广东省阳江市江城区卫城路259号二楼，主销市场为暂无记录，验厂/认证为ISO 9001、ISO 14001、BSCI，合作情况为暂无记录，是否供样为暂无记录，网址为暂无记录，备注为暂无记录。"
> - 指定追加的内容：“数据来源：集团内部 产品开发部。”
> - 追加后的内容："名称为阳江鸿禧家庭用品有限公司的厂商，其信息如下：主营产品为烘焙用品、厨房五金工具，联系方式为曾仕喜 总经理 手机：18926359852 地址：广东省阳江市江城区卫城路259号二楼，主销市场为暂无记录，验厂/认证为ISO 9001、ISO 14001、BSCI，合作情况为暂无记录，是否供样为暂无记录，网址为暂无记录，备注为暂无记录。数据来源：集团内部 产品开发部。"
> - 追加说明：在内容后面追加“数据来源：集团内部 产品开发部。”
> 参数：输入的表格路径，要处理的sheet名字列表，要处理的表头名字列表，输出的表格路径，列名所在的行数，追加内容
> 要求：使用xlwings库  
> 日志要求：给出详细的日志记录，每一个单元格的前后变化要打印出来，方便我跟踪程序和分析工作簿状态
> 注意事项：要正确打开关闭工作簿，警惕文件、进程锁的问题  
> 细节：要有异常捕捉机制
>``` 



>[!example]-  数据去重，通过一个特定的多级规则进行判断
>```markdown
> 先不用写代码，先仔细分析这个函数功能  
>   
> 功能：读取工作簿里指定的表，将指定列的内容作为唯一值，如果有重复数据，根据指定列名列表的内容去重
> 处理逻辑：先读取确定唯一值的列名A，如果存在多条数据的列名A的内容一致，则按照指定列名列表['标签','验厂/认证','主营产品','合作情况']的内容去重，按顺序读取列表，去重逻辑和优先级为： 
> 	1. “标签”列内容都为数字，如果数字不同，保留数字大的，如果数字相同，查看下一个指定列名 
> 	2. “验厂/认证”列内容都为“暂无记录”，则查看下一个指定列名；如果其中一个不是“暂无记录”，则保留此条数据；如果都不是“暂无记录”，则保留字数更多的那条数据 
> 	3. “主营产品”列内容都为“暂无记录”，则查看下一个指定列名；如果其中一个不是“暂无记录”，则保留此条数据；如果都不是“暂无记录”，则保留字数更多的那条数据 
> 	4. “合作情况”列内容都为“暂无记录”，则查看下一个指定列名；如果其中一个不是“暂无记录”，则保留此条数据；如果都不是“暂无记录”，则保留字数更多的那条数据 
> 	……
> 	如果遍历完列名列表后，仍然没有找到符合条件的数据，保留最前面的一条数据。重复的数据中只保留一条，其余的要删除
> 参数：参数：输入的表格路径，要处理的sheet名字列表，确定唯一值的列名A，指定列名列表，输出的表格路径，列名所在的行数
> 要求：使用xlwings库  
> 日志要求：日志要求：给出详细的日志记录，重复的数据信息打印出来，最后保留的数据信息打印出来，要"*"隔开不同的重复的数据，方便我跟踪程序和分析工作簿状态
> 注意事项：要正确打开关闭工作簿，警惕文件、进程锁的问题  
> 细节：要有异常捕捉机制
> ```




>[!example]-  批量汇总表格
>```python
> 先不用写代码，先仔细分析这个函数功能  
>
> 功能：批量汇总多个 Excel 文件到指定的表格 A，以追加的方式。
> 处理逻辑：表格A的字段最多，包含待汇总excel表的所有字段。待汇总的表格汇总到表格A时，有些字段是原本没有的，则这些字段汇总要根据json文件的内容去填写（此json文件说明了当某个字段不存在时要填写什么内容。特殊情况：如果配置为""，则意味着空白即可。示例1："主销市场":"暂无记录" ；示例2："微信":""）
> 参数：输入的表格A路径，表格A的sheet名，从第几行开始追加，存放多个待汇总的excel文件夹路径，配置json文件路径，输出的汇总表格路径，A表格列名所在的行数，待汇总表格列名所在的行数
> 要求：使用xlwings库  
> 日志要求：给出详细的日志记录，每一条汇总的数据都打印出来，并用分割线隔开不同的数据行，方便我跟踪程序和分析工作簿状态
> 注意事项：要正确打开关闭工作簿，警惕文件资源进程锁的问题  
> 细节：要有异常捕捉机制
> ```







